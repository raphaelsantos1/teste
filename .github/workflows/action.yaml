---
name: Yamllint GitHub Actions
on: [push, pull_request]
jobs:
  Yamllint:
    name: yamllint
    runs-on: ubuntu-latest
    outputs:
      files: ${{ steps.files.outputs.files  }}
    steps:
      - name: Checkout
        uses: actions/checkout@v4.1.2
        with:
          fetch-depth: 0
      - name: Install yamllint
        id: install
        run: sudo apt install -y yamllint
      - name: List File
        id: files
        run: |
          for file in $(git diff --name-only ${{ github.event.before }} ${{ github.sha }}); do
            echo $file >> files.txt
          done
          echo "files=$(cat files.txt| tr '\n' ' ' | sed 's/ $/\n/')" >> $GITHUB_OUTPUT
      - name: Yamllint
        uses: karancode/yamllint-github-action@master
        with:
          yamllint_file_or_dir: ${{ steps.files.outputs.files }}
          yamllint_strict: false
          yamllint_comment: true
  Failure:
    name: Failure
    runs-on: ubuntu-latest
    needs: Yamllint
    if: failure()
    steps:
      - name: Error Output
        run: echo ${{  }}
